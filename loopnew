local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")

local player = Players.LocalPlayer

-- Clean up old GUI if exists
local oldGui = player.PlayerGui:FindFirstChild("FakeInjectionPrompt")
if oldGui then oldGui:Destroy() end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FakeInjectionPrompt"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global

-- Fullscreen input blocker frame - near full black
local blocker = Instance.new("Frame")
blocker.Name = "Blocker"
blocker.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
blocker.BackgroundTransparency = 0.15 -- 0.15 transparency = ~85% black
blocker.Size = UDim2.new(1, 0, 1, 0)
blocker.Position = UDim2.new(0, 0, 0, 0)
blocker.Parent = screenGui
blocker.ZIndex = 100
blocker.Active = true
blocker.Selectable = true

-- Centered prompt frame
local promptFrame = Instance.new("Frame")
promptFrame.Name = "PromptFrame"
promptFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
promptFrame.BorderSizePixel = 0
promptFrame.Size = UDim2.new(0, 350, 0, 180)
promptFrame.AnchorPoint = Vector2.new(0.5, 0.5)
promptFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
promptFrame.Parent = blocker
promptFrame.ZIndex = 101
promptFrame.ClipsDescendants = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = promptFrame

-- Title label
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Text = "Script Injection"
title.Font = Enum.Font.GothamBold
title.TextSize = 24
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1
title.Size = UDim2.new(1, -40, 0, 40)
title.Position = UDim2.new(0, 20, 0, 15)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = promptFrame

-- Info label
local info = Instance.new("TextLabel")
info.Name = "Info"
info.Text = "Are you sure you want to inject the script?"
info.Font = Enum.Font.Gotham
info.TextSize = 18
info.TextColor3 = Color3.fromRGB(220, 220, 220)
info.BackgroundTransparency = 1
info.Size = UDim2.new(1, -40, 0, 30)
info.Position = UDim2.new(0, 20, 0, 60)
info.TextXAlignment = Enum.TextXAlignment.Left
info.Parent = promptFrame

-- Countdown label
local countdownLabel = Instance.new("TextLabel")
countdownLabel.Name = "Countdown"
countdownLabel.Text = ""
countdownLabel.Font = Enum.Font.GothamBold
countdownLabel.TextSize = 14
countdownLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
countdownLabel.BackgroundTransparency = 1
countdownLabel.Size = UDim2.new(1, -40, 0, 20)
countdownLabel.Position = UDim2.new(0, 20, 0, 95)
countdownLabel.TextXAlignment = Enum.TextXAlignment.Left
countdownLabel.Parent = promptFrame

-- Buttons frame
local buttonsFrame = Instance.new("Frame")
buttonsFrame.Name = "Buttons"
buttonsFrame.Size = UDim2.new(1, -40, 0, 50)
buttonsFrame.Position = UDim2.new(0, 20, 1, -70)
buttonsFrame.BackgroundTransparency = 1
buttonsFrame.Parent = promptFrame

local yesButton = Instance.new("TextButton")
yesButton.Name = "YesButton"
yesButton.Text = "Yes"
yesButton.Font = Enum.Font.GothamBold
yesButton.TextSize = 18
yesButton.TextColor3 = Color3.fromRGB(0, 0, 0)
yesButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
yesButton.Size = UDim2.new(0.45, 0, 1, 0)
yesButton.Position = UDim2.new(0, 0, 0, 0)
yesButton.AutoButtonColor = false
yesButton.Parent = buttonsFrame

local yesCorner = Instance.new("UICorner")
yesCorner.CornerRadius = UDim.new(0, 8)
yesCorner.Parent = yesButton

local noButton = Instance.new("TextButton")
noButton.Name = "NoButton"
noButton.Text = "No"
noButton.Font = Enum.Font.GothamBold
noButton.TextSize = 18
noButton.TextColor3 = Color3.fromRGB(255, 255, 255)
noButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
noButton.Size = UDim2.new(0.45, 0, 1, 0)
noButton.Position = UDim2.new(0.55, 0, 0, 0)
noButton.AutoButtonColor = false
noButton.Parent = buttonsFrame

local noCorner = Instance.new("UICorner")
noCorner.CornerRadius = UDim.new(0, 8)
noCorner.Parent = noButton

local failReasons = {
    "Poor internet connection",
    "Executor outdated"
}

local function getRandomFailReason()
    return failReasons[math.random(1, #failReasons)]
end

local loopTime = 10
local running = true

local function runLoop()
    while running do
        info.Text = "Are you sure you want to inject the script?"
        local startTime = tick()
        while tick() - startTime < loopTime do
            local remaining = math.ceil(loopTime - (tick() - startTime))
            countdownLabel.Text = "Auto retry in " .. tostring(remaining) .. " seconds..."
            wait(1)
        end

        local failReason = getRandomFailReason()
        info.Text = "Injection failed: " .. failReason

        -- Shake prompt
        for i = 1, 6 do
            local angle = (i % 2 == 0) and 6 or -6
            TweenService:Create(promptFrame, TweenInfo.new(0.07, Enum.EasingStyle.Linear), {Rotation = angle}):Play()
            wait(0.07)
        end
        TweenService:Create(promptFrame, TweenInfo.new(0.1, Enum.EasingStyle.Quad), {Rotation = 0}):Play()
        wait(1)
    end
end

yesButton.MouseButton1Click:Connect(function()
    info.Text = "Injection successful!"
    countdownLabel.Text = ""
    running = false
    TweenService:Create(blocker, TweenInfo.new(1), {BackgroundTransparency = 1}):Play()
    TweenService:Create(promptFrame, TweenInfo.new(1), {BackgroundTransparency = 1}):Play()
    wait(1)
    screenGui:Destroy()
end)

noButton.MouseButton1Click:Connect(function()
    running = false
    screenGui:Destroy()
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.Escape then
        -- Block escape key from closing
    end
end)

coroutine.wrap(runLoop)()
