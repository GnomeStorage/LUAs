-- Advanced Pet Enlargement System
-- With Corruption Effects and Proper Scaling
-- Compatible with Delta/Krnl/Synapse

if not game:IsLoaded() then game.Loaded:Wait() end
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Configuration
local ENLARGE_SCALE = 1.8 -- Base enlargement (matches your images)
local CORRUPTION_CHANCE = 0.3 -- 30% chance to get corrupted variant
local EFFECT_COLOR = Color3.fromRGB(0, 255, 255) -- Light blue from your images
local CORRUPT_COLOR = Color3.fromRGB(255, 50, 50) -- Red for corrupted pets

-- Create the UI (similar to your shop UI)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PetEnlargerUI"
ScreenGui.Parent = game:GetService("CoreGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 200, 0, 250)
MainFrame.Position = UDim2.new(0.8, 0, 0.5, -125)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Text = "PET ENLARGER"
Title.Font = Enum.Font.SciFi
Title.TextSize = 20
Title.TextColor3 = EFFECT_COLOR
Title.Parent = MainFrame

local EnlargeButton = Instance.new("TextButton")
EnlargeButton.Size = UDim2.new(0.9, 0, 0, 40)
EnlargeButton.Position = UDim2.new(0.05, 0, 0.2, 0)
EnlargeButton.BackgroundColor3 = Color3.fromRGB(0, 100, 100)
EnlargeButton.TextColor3 = Color3.new(1, 1, 1)
EnlargeButton.Font = Enum.Font.SciFi
EnlargeButton.TextSize = 18
EnlargeButton.Text = "ENLARGE"
EnlargeButton.Parent = MainFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, 0, 0, 60)
StatusLabel.Position = UDim2.new(0, 0, 0.4, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Hold a pet and click"
StatusLabel.Font = Enum.Font.SciFi
StatusLabel.TextSize = 16
StatusLabel.TextColor3 = Color3.new(1, 1, 1)
StatusLabel.TextWrapped = true
StatusLabel.Parent = MainFrame

local WeightLabel = Instance.new("TextLabel")
WeightLabel.Size = UDim2.new(1, 0, 0, 30)
WeightLabel.Position = UDim2.new(0, 0, 0.7, 0)
WeightLabel.BackgroundTransparency = 1
WeightLabel.Text = "Weight: 0.00KG"
WeightLabel.Font = Enum.Font.SciFi
WeightLabel.TextSize = 16
WeightLabel.TextColor3 = Color3.new(1, 1, 1)
WeightLabel.Parent = MainFrame

local AgeLabel = Instance.new("TextLabel")
AgeLabel.Size = UDim2.new(1, 0, 0, 30)
AgeLabel.Position = UDim2.new(0, 0, 0.8, 0)
AgeLabel.BackgroundTransparency = 1
AgeLabel.Text = "Age: 0"
AgeLabel.Font = Enum.Font.SciFi
AgeLabel.TextSize = 16
AgeLabel.TextColor3 = Color3.new(1, 1, 1)
AgeLabel.Parent = MainFrame

-- Make UI draggable
local dragging = false
local dragInput, dragStart, startPos

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        MainFrame.Position = startPos + UDim2.new(0, delta.X, 0, delta.Y)
    end
end)

-- Corruption effect function
local function applyCorruption(pet)
    -- Change colors to red/orange
    for _, part in ipairs(pet:GetDescendants()) do
        if part:IsA("BasePart") then
            part.Color = CORRUPT_COLOR
            part.Material = Enum.Material.Neon
        end
    end
    
    -- Add crack effects
    local crack = Instance.new("Decal")
    crack.Texture = "rbxassetid://138627691" -- Crack texture
    crack.Face = Enum.NormalId.Top
    crack.Parent = pet.PrimaryPart or pet:FindFirstChildWhichIsA("BasePart")
    
    -- Add floating corruption particles
    local corruptParticles = Instance.new("ParticleEmitter")
    corruptParticles.Texture = "rbxassetid://242806379" -- Smoke texture
    corruptParticles.Color = ColorSequence.new(CORRUPT_COLOR)
    corruptParticles.LightEmission = 1
    corruptParticles.Size = NumberSequence.new(0.5)
    corruptParticles.Parent = pet.PrimaryPart or pet:FindFirstChildWhichIsA("BasePart")
    
    return corruptParticles
end

-- Main enlargement function
local function enlargeHeldPet()
    -- Find held pet (Tool with Handle)
    local heldPet = nil
    for _, tool in ipairs(Character:GetChildren()) do
        if tool:IsA("Tool") and tool:FindFirstChild("Handle") then
            heldPet = tool
            break
        end
    end
    
    if not heldPet then
        StatusLabel.Text = "NO PET HELD\nHold a pet first"
        task.wait(2)
        StatusLabel.Text = "Hold a pet and click"
        return
    end
    
    -- Check for corruption chance
    local isCorrupted = math.random() < CORRUPTION_CHANCE
    local originalColors = {}
    
    -- Store original colors
    for _, part in ipairs(heldPet:GetDescendants()) do
        if part:IsA("BasePart") then
            originalColors[part] = part.Color
        end
    end
    
    -- Create enlargement effect
    local glow = Instance.new("Part")
    glow.Size = Vector3.new(4, 4, 4)
    glow.Position = heldPet.Handle.Position
    glow.Anchored = true
    glow.CanCollide = false
    glow.Material = Enum.Material.Neon
    glow.Color = isCorrupted and CORRUPT_COLOR or EFFECT_COLOR
    glow.Shape = Enum.PartType.Ball
    glow.Transparency = 0.5
    glow.Parent = workspace
    
    local particles = Instance.new("ParticleEmitter")
    particles.Texture = "rbxassetid://242806287" -- Sparkle texture
    particles.LightEmission = 1
    particles.Color = ColorSequence.new(isCorrupted and CORRUPT_COLOR or EFFECT_COLOR)
    particles.Size = NumberSequence.new(0.5)
    particles.Parent = glow
    
    -- Update UI status
    EnlargeButton.Text = "ENLARGING..."
    StatusLabel.Text = isCorrupted and "CORRUPTED!" or "ENLARGED!"
    WeightLabel.Text = string.format("Weight: %.2fKG", math.random() * 5 + 3) -- Random weight 3-8KG
    AgeLabel.Text = "Age: " .. tostring(math.random(20, 25)) -- Random age
    
    -- Apply scaling with different parts getting different scales (like your images)
    for _, part in ipairs(heldPet:GetDescendants()) do
        if part:IsA("BasePart") then
            -- Randomize scale slightly for more organic look
            local partScale = ENLARGE_SCALE * (0.9 + math.random() * 0.2)
            
            -- Some parts get bigger than others (like in your corrupted raccoon)
            if part.Name:lower():find("head") or part.Name:lower():find("torso") then
                partScale = partScale * 1.2
            elseif part.Name:lower():find("leg") or part.Name:lower():find("arm") then
                partScale = partScale * 0.9
            end
            
            local tween = TweenService:Create(part, TweenInfo.new(1.5, Enum.EasingStyle.BackOut), {
                Size = part.Size * partScale
            })
            tween:Play()
        end
    end
    
    -- Apply corruption effects if needed
    local corruptParticles
    if isCorrupted then
        corruptParticles = applyCorruption(heldPet)
    end
    
    -- Create floating "ENLARGED!" text (like in your images)
    local tag = Instance.new("BillboardGui")
    tag.Size = UDim2.new(0, 200, 0, 50)
    tag.StudsOffset = Vector3.new(0, 3, 0)
    tag.Adornee = heldPet.Handle
    tag.AlwaysOnTop = true
    tag.Parent = heldPet
    
    local tagText = Instance.new("TextLabel")
    tagText.Size = UDim2.new(1, 0, 1, 0)
    tagText.BackgroundTransparency = 1
    tagText.Text = isCorrupted and "CORRUPTED!" or "ENLARGED!"
    tagText.TextColor3 = isCorrupted and CORRUPT_COLOR or EFFECT_COLOR
    tagText.Font = Enum.Font.SciFi
    tagText.TextSize = 24
    tagText.TextStrokeTransparency = 0.5
    tagText.Parent = tag
    
    -- Reset after delay
    task.delay(15, function()
        -- Return to normal size
        for part, size in pairs(originalSizes) do
            if part and part.Parent then
                local tween = TweenService:Create(part, TweenInfo.new(1), {
                    Size = size
                })
                tween:Play()
            end
        end
        
        -- Restore original colors
        for part, color in pairs(originalColors) do
            if part and part.Parent then
                part.Color = color
                part.Material = Enum.Material.Plastic
            end
        end
        
        -- Cleanup effects
        if corruptParticles then corruptParticles:Destroy() end
        if tag then tag:Destroy() end
        glow:Destroy()
        
        -- Reset UI
        EnlargeButton.Text = "ENLARGE"
        StatusLabel.Text = "Ready for next pet"
        WeightLabel.Text = "Weight: 0.00KG"
        AgeLabel.Text = "Age: 0"
    end)
end

-- Connect button
EnlargeButton.MouseButton1Click:Connect(enlargeHeldPet)

print("Advanced Pet Enlarger loaded!")
print("CHROLINKZHUB.DEV inspired system active")
